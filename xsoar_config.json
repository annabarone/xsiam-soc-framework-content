{
    "marketplace_packs": [
        {
            "id": "Base",
            "version": "latest"
        },
        {
            "id": "DemistoRESTAPI",
            "version": "latest"
        },
        {
            "id": "ProofpointTAP",
            "version": "latest"
        },
        {
            "id": "Whois",
            "version": "latest"
        }
    ],
    "custom_packs": [
        {
            "id": "SOC_Framework.zip",
            "url": "https://github.com/annabarone/xsiam-soc-framework-content/raw/refs/heads/master/content/uploadable_packs/SOC_Framework.zip",
            "system": "yes"
        },
        {
            "id": "SOC_Framework.tar.gz",
            "url": "https://github.com/Palo-Cortex/soc-optimization/archive/refs/tags/V1.6.1.tar.gz"
        }
    ],
    "lookup_datasets": [
        {
            "dataset_name": "value_tags",
            "dataset_type": "lookup",
            "dataset_schema": {
                "Tag": "text",
                "Time": "text",
                "Vendor": "text",
                "Product": "text",
                "Category": "text",
                "ScriptID": "text",
                "TaskName": "text",
                "PlaybookID": "text",
                "_insert_time": "number",
                "_update_time": "number",
                "_collector_name": "text",
                "_collector_type": "text"
            },
            "url": "https://raw.githubusercontent.com/Palo-Cortex/soc-optimization/refs/heads/main/SOC_Framework/Lookup/value_tags.json"
        }
    ],
    "jobs":[
        {
            "CustomFields": null,
            "type": "##default##",
            "name": "Collect Playbook Metrics",
            "severity": 0,
            "labels": null,
            "details": "",
            "owner": "abarone@paloaltonetworks.com",
            "playbookId": "JOB - Store Playbook Metrics in Dataset",
            "phase": "",
            "startDate": "2025-01-10T23:20:12Z",
            "endingType": "never",
            "times": 0,
            "recurrent": true,
            "endingDate": "2025-01-10T23:18:32Z",
            "humanCron": {
                "days": [
                    "SUN",
                    "MON",
                    "TUE",
                    "WED",
                    "THU",
                    "FRI",
                    "SAT"
                ],
                "timePeriodType": "minutes",
                "timePeriod": 15
            },
            "cronView": false,
            "scheduled": true,
            "tags": null,
            "shouldTriggerNew": true,
            "closePrevRun": false,
            "notifyOwner": false,
            "isFeed": false,
            "selectedFeeds": [],
            "isAllFeeds": false
        },
        {
            "CustomFields": null,
            "type": "##default##",
            "name": "Auto Triage",
            "severity": 0,
            "labels": null,
            "details": "This playbook accesses the API for XSIAM and by default must attract starred alerts within 6 hours or they will be closed as low fidelity alerts.",
            "owner": "abarone@paloaltonetworks.com",
            "playbookId": "JOB - Triage Incidents",
            "phase": "",
            "startDate": "2025-02-05T01:30:48.833Z",
            "endingType": "never",
            "times": 0,
            "recurrent": true,
            "endingDate": "2025-02-05T01:30:48.832Z",
            "humanCron": {
                "days": [
                    "SUN",
                    "MON",
                    "TUE",
                    "WED",
                    "THU",
                    "FRI",
                    "SAT"
                ],
                "timePeriodType": "hours",
                "timePeriod": 1
            },
            "cronView": false,
            "scheduled": false,
            "tags": null,
            "shouldTriggerNew": true,
            "closePrevRun": false,
            "notifyOwner": false,
            "isFeed": false,
            "selectedFeeds": null,
            "isAllFeeds": false
        }
    ],
    "lists": [
        {
            "name": "Job_Utility_Bulk_Alert_Closer_ID_List",
            "value": "1\n2\n3\n4\n"
        },
        {
            "name": "Assets_Type",
            "value": "{\n    \"Admin_Jumpboxes\": [\n        {\n            \"Name\": \"corp-a\",\n            \"IP\": \"10.2.0.20\"\n        },\n        {\n            \"Name\": \"byos-dc-a\",\n            \"IP\": \"10.1.0.20\"\n        }\n    ],\n    \"Admin_Workstations\": [\n        {\n            \"Name\": \"corp-a\",\n            \"IP\": \"10.2.0.20\"\n        }\n    ],\n    \"Admin_Users\": [\n        {\n            \"Name\": \"BYOS\\\\lab-user\"\n        }\n    ],\n    \"Service_Accounts\": [\n        {\n            \"Name\": \"\"\n        }\n    ],\n    \"Management_Servers\": [\n        {\n            \"Name\": \"byos-dc-a\",\n            \"IP\": \"10.1.0.20\"\n        }\n    ]\n}",
            "type": "json"
        },
        {
            "name": "ProductionAssets",
            "value": "{\n    \"Networks\": [\n        {\n            \"CIDR\": \"10.20.20.0/24\"\n        },\n        {\n            \"CIDR\": \"10.20.10.0/24\"\n        }\n    ]\n}",
            "type": "json"
        }
    ],
    "integration_instances": [
        {
            "version": 1,
            "propagationLabels": [
                "all"
            ],
            "isOverridable": false,
            "enabled": "true",
            "name": "PlaybookMetrics",
            "brand": "System XQL HTTP Collector",
            "category": "Utilities",
            "engine": "",
            "engineGroup": "",
            "isIntegrationScript": true,
            "mappingId": "",
            "outgoingMapperId": "",
            "incomingMapperId": "",
            "canSample": false,
            "defaultIgnore": false,
            "integrationLogLevel": "",
            "configuration": {
                "id": "",
                "version": 0,
                "cacheVersn": 0,
                "modified": "0001-01-01T00:00:00Z",
                "sizeInBytes": 0,
                "packID": "",
                "packName": "",
                "itemVersion": "",
                "fromServerVersion": "",
                "toServerVersion": "",
                "definitionId": "",
                "isOverridable": false,
                "vcShouldIgnore": false,
                "vcShouldKeepItemLegacyProdMachine": false,
                "commitMessage": "",
                "shouldCommit": false,
                "name": "",
                "prevName": "",
                "display": "",
                "brand": "",
                "category": "",
                "icon": "",
                "description": "",
                "configuration": null,
                "integrationScript": null,
                "hidden": false,
                "canGetSamples": false
            },
            "data": [
                {
                    "display": "Product Name",
                    "displayPassword": "",
                    "name": "product",
                    "defaultValue": "PlaybookMetrics",
                    "type": 0,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "The name of the 'Product' to include in the event data",
                    "hasvalue": true,
                    "value": "PlaybookMetrics"
                },
                {
                    "display": "vendor name",
                    "displayPassword": "",
                    "name": "vendor",
                    "defaultValue": "XSIAM",
                    "type": 0,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "The name of the 'Vendor' to include in the event data",
                    "hasvalue": true,
                    "value": "XSIAM"
                }
            ],
            "passwordProtected": false
        },
        {
            "version": 11,
            "propagationLabels": [
                "all"
            ],
            "isOverridable": false,
            "enabled": "false",
            "name": "Proofpoint TAP v2_instance_1",
            "brand": "Proofpoint TAP v2",
            "category": "Email",
            "engine": "",
            "engineGroup": "",
            "isIntegrationScript": true,
            "mappingId": "Proofpoint TAP Classifier",
            "outgoingMapperId": "",
            "incomingMapperId": "05e0aeaf-57ca-40f1-8090-1b01e0f80549",
            "canSample": true,
            "defaultIgnore": false,
            "integrationLogLevel": "",
            "configuration": {
                "id": "",
                "version": 0,
                "cacheVersn": 0,
                "modified": "0001-01-01T00:00:00Z",
                "sizeInBytes": 0,
                "packID": "",
                "packName": "",
                "itemVersion": "",
                "fromServerVersion": "",
                "toServerVersion": "",
                "definitionId": "",
                "isOverridable": false,
                "vcShouldIgnore": false,
                "vcShouldKeepItemLegacyProdMachine": false,
                "commitMessage": "",
                "shouldCommit": false,
                "name": "",
                "prevName": "",
                "display": "",
                "brand": "",
                "category": "",
                "icon": "",
                "description": "",
                "configuration": null,
                "integrationScript": null,
                "hidden": false,
                "canGetSamples": false
            },
            "data": [
                {
                    "section": "Collect",
                    "advanced": true,
                    "display": "Events to fetch",
                    "displayPassword": "",
                    "name": "events_type",
                    "defaultValue": "All",
                    "type": 15,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": [
                        "All",
                        "Issues",
                        "Blocked Clicks",
                        "Permitted Clicks",
                        "Blocked Messages",
                        "Delivered Messages"
                    ],
                    "info": "",
                    "hasvalue": true,
                    "value": "All"
                },
                {
                    "section": "Collect",
                    "advanced": true,
                    "display": "Maximum number of incident per fetch",
                    "displayPassword": "",
                    "name": "limit",
                    "defaultValue": "50",
                    "type": 0,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": "200"
                },
                {
                    "section": "Connect",
                    "display": "Server URL",
                    "displayPassword": "",
                    "name": "url",
                    "defaultValue": "https://tap-api-v2.proofpoint.com",
                    "type": 0,
                    "required": true,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "e.g., https://tap-api-v2.proofpoint.com",
                    "hasvalue": true,
                    "value": "https://tap-api-v2.proofpoint.com"
                },
                {
                    "section": "Collect",
                    "display": "Advanced: Raw message encoding",
                    "displayPassword": "",
                    "name": "raw_json_encoding",
                    "defaultValue": "",
                    "type": 0,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "The character encoding to apply on the message fetched (e.g. latin-1). Advanced configuration to be used only if instructed by XSOAR Support",
                    "hasvalue": false,
                    "value": null
                },
                {
                    "section": "Collect",
                    "display": "Fetch incidents",
                    "displayPassword": "",
                    "name": "isFetch",
                    "defaultValue": "",
                    "type": 8,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": true
                },
                {
                    "display": "Alerts Fetch Interval",
                    "displayPassword": "",
                    "name": "alertFetchInterval",
                    "defaultValue": "1",
                    "type": 19,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": "1"
                },
                {
                    "section": "Connect",
                    "display": "Service Principal",
                    "displayPassword": "",
                    "name": "credentials",
                    "defaultValue": "",
                    "type": 9,
                    "required": true,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "The password refers to secret",
                    "hasvalue": true,
                    "value": {
                        "credential": "",
                        "credentials": {
                            "cacheVersn": 0,
                            "id": "",
                            "locked": false,
                            "modified": "0001-01-01T00:00:00Z",
                            "name": "",
                            "sizeInBytes": 0,
                            "user": "",
                            "vaultInstanceId": "",
                            "version": 0,
                            "workgroup": ""
                        },
                        "identifier": "test_REPLACE",
                        "passwordChanged": false
                    }
                },
                {
                    "section": "Collect",
                    "advanced": true,
                    "display": "Threat type",
                    "displayPassword": "",
                    "name": "threat_type",
                    "defaultValue": "",
                    "type": 16,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": [
                        "url",
                        "attachment",
                        "messageText"
                    ],
                    "info": "A string specifying which threat type to return. If empty, all threat types are returned. Can be \"url\", \"attachment\", or \"messageText\".",
                    "hasvalue": true,
                    "value": []
                },
                {
                    "section": "Collect",
                    "advanced": true,
                    "display": "Threat status",
                    "displayPassword": "",
                    "name": "threat_status",
                    "defaultValue": "",
                    "type": 16,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": [
                        "active",
                        "cleared",
                        "falsePositive"
                    ],
                    "info": "A string specifying which threat statuses to return. If empty, will return \"active\" and \"cleared\" threats. Can be \"active\", \"cleared\", or \"falsePositive\".",
                    "hasvalue": true,
                    "value": []
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Trust any certificate (not secure)",
                    "displayPassword": "",
                    "name": "insecure",
                    "defaultValue": "",
                    "type": 8,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": false
                },
                {
                    "section": "Collect",
                    "display": "First fetch time range",
                    "displayPassword": "",
                    "name": "fetch_time",
                    "defaultValue": "1 hour",
                    "type": 0,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "First fetch time range (<number> <time unit>, e.g., 1 hour, 30 minutes). Proofpoint supports a maximum 1 week fetch back.",
                    "hasvalue": true,
                    "value": "1 hour"
                },
                {
                    "section": "Connect",
                    "display": "Incident type",
                    "displayPassword": "",
                    "name": "incidentType",
                    "defaultValue": "",
                    "type": 13,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": false,
                    "value": null
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Use system proxy settings",
                    "displayPassword": "",
                    "name": "proxy",
                    "defaultValue": "",
                    "type": 8,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": false
                },
                {
                    "display": "",
                    "displayPassword": "",
                    "name": "feed",
                    "defaultValue": "",
                    "type": 0,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": false
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "API Version",
                    "displayPassword": "",
                    "name": "api_version",
                    "defaultValue": "v2",
                    "type": 15,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": [
                        "v1",
                        "v2"
                    ],
                    "info": "v1 is deprecated for new instances. The current API version is v2.",
                    "hasvalue": true,
                    "value": "v2"
                }
            ],
            "passwordProtected": false
        },
        {
            "version": 19,
            "propagationLabels": [
                "all"
            ],
            "isOverridable": false,
            "enabled": "true",
            "name": "Whois_instance_1",
            "brand": "Whois",
            "category": "Data Enrichment & Threat Intelligence",
            "engine": "",
            "engineGroup": "",
            "isIntegrationScript": true,
            "mappingId": "",
            "outgoingMapperId": "",
            "incomingMapperId": "",
            "canSample": false,
            "defaultIgnore": false,
            "integrationLogLevel": "",
            "configuration": {
                "id": "",
                "version": 0,
                "cacheVersn": 0,
                "modified": "0001-01-01T00:00:00Z",
                "sizeInBytes": 0,
                "packID": "",
                "packName": "",
                "itemVersion": "",
                "fromServerVersion": "",
                "toServerVersion": "",
                "definitionId": "",
                "isOverridable": false,
                "vcShouldIgnore": false,
                "vcShouldKeepItemLegacyProdMachine": false,
                "commitMessage": "",
                "shouldCommit": false,
                "name": "",
                "prevName": "",
                "display": "",
                "brand": "",
                "category": "",
                "icon": "",
                "description": "",
                "configuration": null,
                "integrationScript": null,
                "hidden": false,
                "canGetSamples": false
            },
            "data": [
                {
                    "section": "Collect",
                    "advanced": true,
                    "display": "Rate Limit Wait Seconds",
                    "displayPassword": "",
                    "name": "rate_limit_wait_seconds",
                    "defaultValue": "120",
                    "type": 0,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "The number of seconds to wait each iteration when getting a Rate Limit response.",
                    "hasvalue": true,
                    "value": "120"
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Return Errors",
                    "displayPassword": "",
                    "name": "with_error",
                    "defaultValue": "",
                    "type": 8,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "If set, failed command results will be returned as warnings instead of errors.",
                    "hasvalue": true,
                    "value": false
                },
                {
                    "section": "Collect",
                    "display": "Source Reliability",
                    "displayPassword": "",
                    "name": "integrationReliability",
                    "defaultValue": "B - Usually reliable",
                    "type": 15,
                    "required": true,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": [
                        "A+ - 3rd party enrichment",
                        "A - Completely reliable",
                        "B - Usually reliable",
                        "C - Fairly reliable",
                        "D - Not usually reliable",
                        "E - Unreliable",
                        "F - Reliability cannot be judged"
                    ],
                    "info": "Reliability of the source providing the intelligence data.",
                    "hasvalue": true,
                    "value": "B - Usually reliable"
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Use system proxy settings",
                    "displayPassword": "",
                    "name": "proxy",
                    "defaultValue": "",
                    "type": 8,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "Effect the `ip` command and the other commands only if the Proxy URL is not set.",
                    "hasvalue": true,
                    "value": false
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Proxy URL",
                    "displayPassword": "",
                    "name": "proxy_url",
                    "defaultValue": "",
                    "type": 0,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "Supports socks4/socks5/http connect proxies (e.g. socks5h://host:1080). Will effect all commands except for the `ip` command.",
                    "hasvalue": false,
                    "value": null
                },
                {
                    "section": "Collect",
                    "advanced": true,
                    "display": "Suppress Rate Limit errors",
                    "displayPassword": "",
                    "name": "rate_limit_errors_suppressed",
                    "defaultValue": "false",
                    "type": 8,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "Whether Rate Limit errors should be supressed or not.",
                    "hasvalue": true,
                    "value": false
                },
                {
                    "section": "Collect",
                    "advanced": true,
                    "display": "Rate Limit Retry Count",
                    "displayPassword": "",
                    "name": "rate_limit_retry_count",
                    "defaultValue": "0",
                    "type": 0,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "The number of times to try when getting a Rate Limit response.",
                    "hasvalue": true,
                    "value": "3"
                }
            ],
            "passwordProtected": false
        }
    ],
    "correlation_rules": [
        {
            "name": "Production Proofpoint TAP - Messages Blocked or Clicks Blocked",
            "severity": "SEV_020_LOW",
            "xql_query": "dataset = proofpoint_tap_v2_generic_alert_raw\n| filter _alert_data != null and (type = \"messages blocked\" or type = \"clicks blocked\")\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")",
            "is_enabled": true,
            "description": "Messages Blocked and Clicks Blocked for added context in incidents",
            "alert_name": "$alert_name",
            "alert_category": "User Defined",
            "alert_type": null,
            "alert_description": "$alert_description",
            "alert_domain": "DOMAIN_SECURITY",
            "alert_fields": {},
            "execution_mode": "REAL_TIME",
            "search_window": null,
            "simple_schedule": null,
            "timezone": null,
            "crontab": null,
            "suppression_enabled": true,
            "suppression_duration": "6 hours",
            "suppression_fields": [
              "message_id"
            ],
            "dataset": "alerts",
            "user_defined_severity": null,
            "user_defined_category": "alert_category",
            "mitre_defs": {},
            "investigation_query_link": "",
            "drilldown_query_timeframe": "ALERT",
            "mapping_strategy": "AUTO",
            "action": "ALERTS",
            "lookup_mapping": []
        },
        {
            "name": "Production Proofpoint TAP - Messages Delivered",
            "severity": "User Defined",
            "xql_query": "dataset = proofpoint_tap_v2_generic_alert_raw\n| filter type = \"messaged delivered\"\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")",
            "is_enabled": true,
            "description": "Messages Delivered",
            "alert_name": "$alert_name",
            "alert_category": "User Defined",
            "alert_type": null,
            "alert_description": "$alert_description",
            "alert_domain": "DOMAIN_SECURITY",
            "alert_fields": {},
            "execution_mode": "REAL_TIME",
            "search_window": null,
            "simple_schedule": null,
            "timezone": null,
            "crontab": null,
            "suppression_enabled": true,
            "suppression_duration": "6 hours",
            "suppression_fields": [
              "message_id"
            ],
            "dataset": "alerts",
            "user_defined_severity": "alert_severity",
            "user_defined_category": "alert_category",
            "mitre_defs": {},
            "investigation_query_link": "",
            "drilldown_query_timeframe": "ALERT",
            "mapping_strategy": "AUTO",
            "action": "ALERTS",
            "lookup_mapping": []
        }
    ],
    "dashboards": [
        {
            "name": "XSIAM_SOC_Value_Metrics_Dashboard.json",
            "url": "https://raw.githubusercontent.com/Palo-Cortex/soc-optimization/refs/heads/main/SOC_Framework/Dashboards/XSIAM_SOC_Value_Metrics_Dashboard.json"
        }
    ]
}
